<div class="container">
  <h1 class="title">Questionnaire</h1>

  <form [formGroup]="qForm" (ngSubmit)="save()">
    <div class="form-group title-section">
      <label>Title:</label>
      <input type="text" formControlName="title" placeholder="Enter questionnaire title" />
    </div>

    <div formArrayName="questions">
      <div *ngFor="let q of questions.controls; let i = index" [formGroupName]="i" class="question-block">
        
        <label>Question {{ i + 1 }}:</label>
        <input type="text" formControlName="text" placeholder="Enter question text" />

        <label>Type:</label>
        <select formControlName="type">
          <option *ngFor="let type of questionTypes" [value]="type">{{ type }}</option>
        </select>

        <!-- Options for RADIO -->
        <div *ngIf="questions.at(i).get('type')?.value === 'radio'">
          <div formArrayName="options">
            <div *ngFor="let opt of getOptions(i).controls; let j = index">
              <input [formControlName]="j" placeholder="Option {{ j + 1 }}" />
              <button type="button" (click)="removeOption(i, j)">Remove</button>
            </div>
          </div>
          <button type="button" (click)="addOption(i)">+ Add Option</button>
        </div>

        <!-- Options for CHECKBOX -->
        <div *ngIf="questions.at(i).get('type')?.value === 'checkbox'">
          <div formArrayName="options">
            <div *ngFor="let opt of getOptions(i).controls; let j = index">
              <input [formControlName]="j" placeholder="Option {{ j + 1 }}" />
              <button type="button" (click)="removeOption(i, j)">Remove</button>
            </div>
          </div>
          <button type="button" (click)="addOption(i)">+ Add Option</button>
        </div>

        <button type="button" class="remove-btn" (click)="removeQuestion(i)">Remove Question</button>
      </div>
    </div>

    <button type="button" class="add-btn" (click)="addQuestion()">+ Add Question</button>
    <br /><br />
    <button type="submit" class="save-btn">Save Questionnaire</button>
  </form>
</div>
